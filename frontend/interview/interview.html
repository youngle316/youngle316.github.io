<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å‰ç«¯é¢è¯•é¢˜è®°å½• | YoungLeçš„åšå®¢</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.ico">
    <script>
  var _hmt = _hmt || [];
  (function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d87e4e0c080c2c7c4d7316a38a77da04";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);

  // å¼•å…¥è°·æ­Œ,ä¸éœ€è¦å¯åˆ é™¤è¿™æ®µ
  var hm1 = document.createElement("script");
  hm1.src = "https://www.googletagmanager.com/gtag/js?id=UA-131182082-1";
  var s1 = document.getElementsByTagName("script")[0]; 
  s1.parentNode.insertBefore(hm1, s1);
  })();

  // è°·æ­ŒåŠ è½½,ä¸éœ€è¦å¯åˆ é™¤
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131182082-1');
</script>
    <meta name="description" content="è®°å½•å­¦ä¹ è·¯ä¸Šçš„ç‚¹ç‚¹æ»´æ»´">
    <link rel="preload" href="/assets/css/0.styles.09801f63.css" as="style"><link rel="preload" href="/assets/js/app.feb85b9e.js" as="script"><link rel="preload" href="/assets/js/2.95f1b8bb.js" as="script"><link rel="preload" href="/assets/js/53.83955275.js" as="script"><link rel="prefetch" href="/assets/js/10.6cc9b3f4.js"><link rel="prefetch" href="/assets/js/11.bbed2d26.js"><link rel="prefetch" href="/assets/js/12.bc055c47.js"><link rel="prefetch" href="/assets/js/13.00f6792f.js"><link rel="prefetch" href="/assets/js/14.bfaa6883.js"><link rel="prefetch" href="/assets/js/15.760f6750.js"><link rel="prefetch" href="/assets/js/16.7d3ea788.js"><link rel="prefetch" href="/assets/js/17.5a06d58d.js"><link rel="prefetch" href="/assets/js/18.e14a7fca.js"><link rel="prefetch" href="/assets/js/19.cc576287.js"><link rel="prefetch" href="/assets/js/20.85987309.js"><link rel="prefetch" href="/assets/js/21.07415e4a.js"><link rel="prefetch" href="/assets/js/22.d29797ef.js"><link rel="prefetch" href="/assets/js/23.1955b7f3.js"><link rel="prefetch" href="/assets/js/24.78e02f69.js"><link rel="prefetch" href="/assets/js/25.0c13be5e.js"><link rel="prefetch" href="/assets/js/26.9b3f496e.js"><link rel="prefetch" href="/assets/js/27.1d7bfdbb.js"><link rel="prefetch" href="/assets/js/28.b7ab2e46.js"><link rel="prefetch" href="/assets/js/29.756db6fc.js"><link rel="prefetch" href="/assets/js/3.77baa758.js"><link rel="prefetch" href="/assets/js/30.095c40e0.js"><link rel="prefetch" href="/assets/js/31.509ba86e.js"><link rel="prefetch" href="/assets/js/32.609d4df3.js"><link rel="prefetch" href="/assets/js/33.c9ee8cff.js"><link rel="prefetch" href="/assets/js/34.490ce828.js"><link rel="prefetch" href="/assets/js/35.f0c9a6bd.js"><link rel="prefetch" href="/assets/js/36.4c14807d.js"><link rel="prefetch" href="/assets/js/37.faa6d4aa.js"><link rel="prefetch" href="/assets/js/38.7976991e.js"><link rel="prefetch" href="/assets/js/39.08e9ac63.js"><link rel="prefetch" href="/assets/js/4.d729705c.js"><link rel="prefetch" href="/assets/js/40.b4692119.js"><link rel="prefetch" href="/assets/js/41.24ba5520.js"><link rel="prefetch" href="/assets/js/42.53d91651.js"><link rel="prefetch" href="/assets/js/43.213c1b8e.js"><link rel="prefetch" href="/assets/js/44.b762d3e6.js"><link rel="prefetch" href="/assets/js/45.24076f7e.js"><link rel="prefetch" href="/assets/js/46.cf7ddf0a.js"><link rel="prefetch" href="/assets/js/47.972c7130.js"><link rel="prefetch" href="/assets/js/48.112dbf31.js"><link rel="prefetch" href="/assets/js/49.1984dfaf.js"><link rel="prefetch" href="/assets/js/5.3712046a.js"><link rel="prefetch" href="/assets/js/50.28485bdb.js"><link rel="prefetch" href="/assets/js/51.cef03a47.js"><link rel="prefetch" href="/assets/js/52.b0d637f7.js"><link rel="prefetch" href="/assets/js/54.b117ee9a.js"><link rel="prefetch" href="/assets/js/55.d20659ca.js"><link rel="prefetch" href="/assets/js/56.4f8523e9.js"><link rel="prefetch" href="/assets/js/57.ef6c07b9.js"><link rel="prefetch" href="/assets/js/58.07ea91a2.js"><link rel="prefetch" href="/assets/js/59.713eb32c.js"><link rel="prefetch" href="/assets/js/6.816080ba.js"><link rel="prefetch" href="/assets/js/60.fa1332f1.js"><link rel="prefetch" href="/assets/js/61.723b1598.js"><link rel="prefetch" href="/assets/js/62.6bbb1d25.js"><link rel="prefetch" href="/assets/js/7.755a946b.js"><link rel="prefetch" href="/assets/js/8.02c1d897.js"><link rel="prefetch" href="/assets/js/9.c7f08bfd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.09801f63.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">YoungLeçš„åšå®¢</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯" class="mobile-dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/interview/interview.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å‰ç«¯é¢è¯•é¢˜
</a></li><li class="dropdown-item"><!----> <a href="/frontend/JavaScript/js/deep-copy.html" class="nav-link">
  å‰ç«¯ä¸‰å‰æˆŸ
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ES6/es6-basic.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/frontend/React/ReactBasic/learn-react-through-the-todo-project.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/Webpack/webpack-config.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/typescript/typescript-basic-type.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/performance/" class="nav-link">
  æ€§èƒ½ä¼˜åŒ–
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç®—æ³•" class="mobile-dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/Array/26-Remove-Duplicates-from-Sorted-Array.html" class="nav-link">
  æ•°ç»„
</a></li></ul></div></div><div class="nav-item"><a href="/handwriting/" class="nav-link">
  æ‰‹å†™ç³»åˆ—
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åšå®¢" class="dropdown-title"><span class="title">åšå®¢</span> <span class="arrow down"></span></button> <button type="button" aria-label="åšå®¢" class="mobile-dropdown-title"><span class="title">åšå®¢</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/hackintosh/use-hackintool-custom-made-usb3.0.html" class="nav-link">
  é»‘è‹¹æœ
</a></li><li class="dropdown-item"><!----> <a href="/blog/technology/use-hexo-build-blog.html" class="nav-link">
  æŠ€æœ¯
</a></li><li class="dropdown-item"><!----> <a href="/blog/skill/add-eslint-prettier-for-react.html" class="nav-link">
  æŠ€å·§
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/youngle316" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸ªäººé¡¹ç›®" class="dropdown-title"><span class="title">ä¸ªäººé¡¹ç›®</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸ªäººé¡¹ç›®" class="mobile-dropdown-title"><span class="title">ä¸ªäººé¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/youngle316/ASRock-Z370M-ITX-AC" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Z370-itx Hackintosh
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯" class="mobile-dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/interview/interview.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å‰ç«¯é¢è¯•é¢˜
</a></li><li class="dropdown-item"><!----> <a href="/frontend/JavaScript/js/deep-copy.html" class="nav-link">
  å‰ç«¯ä¸‰å‰æˆŸ
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ES6/es6-basic.html" class="nav-link">
  ES6
</a></li><li class="dropdown-item"><!----> <a href="/frontend/React/ReactBasic/learn-react-through-the-todo-project.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/frontend/Webpack/webpack-config.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/typescript/typescript-basic-type.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/performance/" class="nav-link">
  æ€§èƒ½ä¼˜åŒ–
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç®—æ³•" class="mobile-dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithm/Array/26-Remove-Duplicates-from-Sorted-Array.html" class="nav-link">
  æ•°ç»„
</a></li></ul></div></div><div class="nav-item"><a href="/handwriting/" class="nav-link">
  æ‰‹å†™ç³»åˆ—
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åšå®¢" class="dropdown-title"><span class="title">åšå®¢</span> <span class="arrow down"></span></button> <button type="button" aria-label="åšå®¢" class="mobile-dropdown-title"><span class="title">åšå®¢</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/hackintosh/use-hackintool-custom-made-usb3.0.html" class="nav-link">
  é»‘è‹¹æœ
</a></li><li class="dropdown-item"><!----> <a href="/blog/technology/use-hexo-build-blog.html" class="nav-link">
  æŠ€æœ¯
</a></li><li class="dropdown-item"><!----> <a href="/blog/skill/add-eslint-prettier-for-react.html" class="nav-link">
  æŠ€å·§
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/youngle316" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸ªäººé¡¹ç›®" class="dropdown-title"><span class="title">ä¸ªäººé¡¹ç›®</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸ªäººé¡¹ç›®" class="mobile-dropdown-title"><span class="title">ä¸ªäººé¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/youngle316/ASRock-Z370M-ITX-AC" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Z370-itx Hackintosh
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å‰ç«¯é¢è¯•é¢˜</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/interview/interview.html" aria-current="page" class="active sidebar-link">å‰ç«¯é¢è¯•é¢˜è®°å½•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_1-å†™-react-vue-é¡¹ç›®æ—¶ä¸ºä»€ä¹ˆè¦åœ¨åˆ—è¡¨ç»„ä»¶ä¸­å†™-key-å…¶ä½œç”¨æ˜¯ä»€ä¹ˆ" class="sidebar-link">1. å†™ React / Vue é¡¹ç›®æ—¶ä¸ºä»€ä¹ˆè¦åœ¨åˆ—è¡¨ç»„ä»¶ä¸­å†™ keyï¼Œå…¶ä½œç”¨æ˜¯ä»€ä¹ˆ</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_2-1-2-3-map-parseint-what-why" class="sidebar-link">2. ['1', '2', '3'].map(parseInt) what &amp; why</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_3-ä»€ä¹ˆæ˜¯é˜²æŠ–å’ŒèŠ‚æµ-æœ‰ä»€ä¹ˆåŒºåˆ«-å¦‚ä½•å®ç°" class="sidebar-link">3. ä»€ä¹ˆæ˜¯é˜²æŠ–å’ŒèŠ‚æµï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¦‚ä½•å®ç°</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_4-ä»‹ç»ä¸‹-setã€mapã€weakset-å’Œ-weakmap-çš„åŒºåˆ«" class="sidebar-link">4. ä»‹ç»ä¸‹ Setã€Mapã€WeakSet å’Œ WeakMap çš„åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_5-es5-es6-çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«" class="sidebar-link">5. ES5/ES6 çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_6-settimeoutã€promiseã€async-await-çš„åŒºåˆ«" class="sidebar-link">6. setTimeoutã€Promiseã€Async/Await çš„åŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_7-async-await-å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥" class="sidebar-link">7. Async/Await å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_8-å¼‚æ­¥ç¬”è¯•é¢˜" class="sidebar-link">8. å¼‚æ­¥ç¬”è¯•é¢˜</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_9-ç®—æ³•æ‰‹å†™é¢˜" class="sidebar-link">9. ç®—æ³•æ‰‹å†™é¢˜</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_10-js-å¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹" class="sidebar-link">10. JS å¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_11-promise-æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œ-é‚£ä¹ˆ-then-æ–¹æ³•å‘¢" class="sidebar-link">11. Promise æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆ then æ–¹æ³•å‘¢</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_12-å¦‚ä½•å®ç°ä¸€ä¸ª-new" class="sidebar-link">12. å¦‚ä½•å®ç°ä¸€ä¸ª new</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_13-react-ä¸­-setstate-ä»€ä¹ˆæ—¶å€™æ˜¯åŒæ­¥çš„-ä»€ä¹ˆæ—¶å€™æ˜¯å¼‚æ­¥çš„" class="sidebar-link">13. React ä¸­ setState ä»€ä¹ˆæ—¶å€™æ˜¯åŒæ­¥çš„ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯å¼‚æ­¥çš„</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_14-react-setstate-ç¬”è¯•é¢˜-ä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆ" class="sidebar-link">14. React setState ç¬”è¯•é¢˜ï¼Œä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆ</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_15-æœ‰ä»¥ä¸‹-3-ä¸ªåˆ¤æ–­æ•°ç»„çš„æ–¹æ³•-è¯·åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£" class="sidebar-link">15. æœ‰ä»¥ä¸‹ 3 ä¸ªåˆ¤æ–­æ•°ç»„çš„æ–¹æ³•ï¼Œè¯·åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_16-ä»‹ç»ä¸‹è§‚å¯Ÿè€…æ¨¡å¼å’Œè®¢é˜…-å‘å¸ƒæ¨¡å¼çš„åŒºåˆ«-å„è‡ªé€‚ç”¨äºä»€ä¹ˆåœºæ™¯" class="sidebar-link">16. ä»‹ç»ä¸‹è§‚å¯Ÿè€…æ¨¡å¼å’Œè®¢é˜…-å‘å¸ƒæ¨¡å¼çš„åŒºåˆ«ï¼Œå„è‡ªé€‚ç”¨äºä»€ä¹ˆåœºæ™¯</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_17-å…¨å±€ä½œç”¨åŸŸä¸­-ç”¨-const-å’Œ-let-å£°æ˜çš„å˜é‡ä¸åœ¨-window-ä¸Š-é‚£åˆ°åº•åœ¨å“ªé‡Œ-å¦‚ä½•å»è·å–" class="sidebar-link">17. å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œç”¨ const å’Œ let å£°æ˜çš„å˜é‡ä¸åœ¨ window ä¸Šï¼Œé‚£åˆ°åº•åœ¨å“ªé‡Œï¼Ÿå¦‚ä½•å»è·å–</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_18-æ”¹é€ ä¸‹é¢çš„ä»£ç -ä½¿ä¹‹è¾“å‡º0-9-å†™å‡ºä½ èƒ½æƒ³åˆ°çš„æ‰€æœ‰è§£æ³•" class="sidebar-link">18. æ”¹é€ ä¸‹é¢çš„ä»£ç ï¼Œä½¿ä¹‹è¾“å‡º0 - 9ï¼Œå†™å‡ºä½ èƒ½æƒ³åˆ°çš„æ‰€æœ‰è§£æ³•</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_19-virtual-dom-çœŸçš„æ¯”æ“ä½œåŸç”Ÿ-dom-å¿«å—-è°ˆè°ˆä½ çš„æƒ³æ³•" class="sidebar-link">19. Virtual DOM çœŸçš„æ¯”æ“ä½œåŸç”Ÿ DOM å¿«å—ï¼Ÿè°ˆè°ˆä½ çš„æƒ³æ³•</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_20-ä¸‹é¢çš„ä»£ç æ‰“å°ä»€ä¹ˆå†…å®¹-ä¸ºä»€ä¹ˆ" class="sidebar-link">20. ä¸‹é¢çš„ä»£ç æ‰“å°ä»€ä¹ˆå†…å®¹ï¼Œä¸ºä»€ä¹ˆ</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_21-ç®€å•æ”¹é€ ä¸‹é¢çš„ä»£ç -ä½¿ä¹‹åˆ†åˆ«æ‰“å°-10-å’Œ-20" class="sidebar-link">21. ç®€å•æ”¹é€ ä¸‹é¢çš„ä»£ç ï¼Œä½¿ä¹‹åˆ†åˆ«æ‰“å° 10 å’Œ 20</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_22-å®ç°ä¸€ä¸ª-sleep-å‡½æ•°" class="sidebar-link">22. å®ç°ä¸€ä¸ª sleep å‡½æ•°</a></li><li class="sidebar-sub-header"><a href="/frontend/interview/interview.html#_23-ä½¿ç”¨-sort-å¯¹æ•°ç»„-3-15-8-29-102-22-è¿›è¡Œæ’åº-è¾“å‡ºç»“æœ" class="sidebar-link">23. ä½¿ç”¨ sort() å¯¹æ•°ç»„ [3, 15, 8, 29, 102, 22] è¿›è¡Œæ’åºï¼Œè¾“å‡ºç»“æœ</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="å‰ç«¯é¢è¯•é¢˜è®°å½•"><a href="#å‰ç«¯é¢è¯•é¢˜è®°å½•" class="header-anchor">#</a> å‰ç«¯é¢è¯•é¢˜è®°å½•</h1> <blockquote><p>è¿™é‡Œè®°å½•äº†å¸¸è§çš„å‰ç«¯é¢è¯•é¢˜ï¼Œå‰ç«¯çš„çŸ¥è¯†ç‚¹å¯ä»¥åœ¨é¡¶éƒ¨çš„å¯¼èˆªæ æŸ¥çœ‹</p></blockquote> <h2 id="_1-å†™-react-vue-é¡¹ç›®æ—¶ä¸ºä»€ä¹ˆè¦åœ¨åˆ—è¡¨ç»„ä»¶ä¸­å†™-key-å…¶ä½œç”¨æ˜¯ä»€ä¹ˆ"><a href="#_1-å†™-react-vue-é¡¹ç›®æ—¶ä¸ºä»€ä¹ˆè¦åœ¨åˆ—è¡¨ç»„ä»¶ä¸­å†™-key-å…¶ä½œç”¨æ˜¯ä»€ä¹ˆ" class="header-anchor">#</a> 1. å†™ React / Vue é¡¹ç›®æ—¶ä¸ºä»€ä¹ˆè¦åœ¨åˆ—è¡¨ç»„ä»¶ä¸­å†™ keyï¼Œå…¶ä½œç”¨æ˜¯ä»€ä¹ˆ</h2> <p>Keyæ˜¯Reactç”¨äºè¿½è¸ªé‚£äº›åˆ—è¡¨ä¸­å…ƒç´ è¢«ä¿®æ”¹ã€è¢«æ·»åŠ æˆ–è€…è¢«ç§»é™¤çš„è¾…åŠ©æ ‡è¯†ã€‚</p> <p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯æŸä¸ªå…ƒç´ çš„key åœ¨å…¶åŒçº§å…ƒç´ ä¸­å…·æœ‰å”¯-ä¸€æ€§ã€‚ åœ¨React Diffç®—æ³•ä¸­React ä¼šå€ŸåŠ©å…ƒç´ çš„Keyå€¼æ¥åˆ¤æ–­è¯¥å…ƒç´ æ˜¯æ–°è¿‘åˆ›å»ºçš„è¿˜æ˜¯è¢«ç§»åŠ¨è€Œæ¥çš„å…ƒç´ ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„å…ƒç´ é‡æ¸²æŸ“ã€‚æ­¤å¤–,Reactè¿˜éœ€è¦å€ŸåŠ©Keyå€¼æ¥åˆ¤æ–­å…ƒç´ ä¸æœ¬åœ°çŠ¶æ€çš„å…³è”å…³ç³»ï¼Œå› æ­¤æˆ‘ä»¬ç»ä¸å¯å¿½è§†è½¬æ¢å‡½æ•°ä¸­Keyçš„é‡è¦æ€§ã€‚</p> <h2 id="_2-1-2-3-map-parseint-what-why"><a href="#_2-1-2-3-map-parseint-what-why" class="header-anchor">#</a> 2. <code>['1', '2', '3'].map(parseInt)</code> what &amp; why</h2> <h3 id="parseint"><a href="#parseint" class="header-anchor">#</a> parseInt</h3> <p><code>parseInt(string, radix)</code> å°†ä¸€ä¸ªå­—ç¬¦ä¸² string è½¬æ¢ä¸º radix è¿›åˆ¶çš„æ•´æ•°ï¼Œ radix ä¸ºä»‹äº2-36ä¹‹é—´çš„æ•°ã€‚</p> <p><code>string</code>:è¦è¢«è§£æçš„å€¼ã€‚å¦‚æœå‚æ•°ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²(ä½¿ç”¨<code>ToString</code>æŠ½è±¡æ“ä½œ)ã€‚å­—ç¬¦ä¸²å¼€å¤´çš„ç©ºç™½ç¬¦å°†ä¼šè¢«å¿½ç•¥ã€‚</p> <p><code>radix</code>:ä¸€ä¸ªä»‹äº2å’Œ36ä¹‹é—´çš„æ•´æ•°(æ•°å­¦ç³»ç»Ÿçš„åŸºç¡€)ï¼Œè¡¨ç¤ºä¸Šè¿°å­—ç¬¦ä¸²çš„<strong>åŸºæ•°</strong>ã€‚æ¯”å¦‚å‚æ•° 10 è¡¨ç¤ºä½¿ç”¨åè¿›åˆ¶æ•°å€¼ç³»ç»Ÿã€‚</p> <p><code>è¿”å›å€¼</code>ï¼šè¿”å›è§£æåçš„æ•´æ•°å€¼ã€‚ å¦‚æœè¢«è§£æå‚æ•°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ— æ³•è¢«è½¬åŒ–æˆæ•°å€¼ç±»å‹ï¼Œåˆ™è¿”å› NaNã€‚</p> <p><strong>æ³¨æ„ï¼š</strong>
åœ¨<code>radix</code>ä¸º undefinedï¼Œæˆ–è€…<code>radix</code>ä¸º 0 æˆ–è€…æ²¡æœ‰æŒ‡å®šçš„æƒ…å†µä¸‹ï¼ŒJavaScript ä½œå¦‚ä¸‹å¤„ç†ï¼š</p> <ul><li>å¦‚æœå­—ç¬¦ä¸² string ä»¥&quot;0x&quot;æˆ–è€…&quot;0X&quot;å¼€å¤´, åˆ™åŸºæ•°æ˜¯16 (16è¿›åˆ¶).</li> <li>å¦‚æœå­—ç¬¦ä¸² string ä»¥&quot;0&quot;å¼€å¤´, åŸºæ•°æ˜¯8ï¼ˆå…«è¿›åˆ¶ï¼‰æˆ–è€…10ï¼ˆåè¿›åˆ¶ï¼‰ï¼Œé‚£ä¹ˆå…·ä½“æ˜¯å“ªä¸ªåŸºæ•°ç”±å®ç°ç¯å¢ƒå†³å®šã€‚ECMAScript 5 è§„å®šä½¿ç”¨10ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½éµå¾ªè¿™ä¸ªè§„å®šã€‚å› æ­¤ï¼Œæ°¸è¿œéƒ½è¦æ˜ç¡®ç»™å‡ºradixå‚æ•°çš„å€¼ã€‚</li> <li>å¦‚æœå­—ç¬¦ä¸² string ä»¥å…¶å®ƒä»»ä½•å€¼å¼€å¤´ï¼Œåˆ™åŸºæ•°æ˜¯10 (åè¿›åˆ¶)ã€‚</li></ul> <p>æ‰€ä»¥è¿™é¢˜çš„å®é™…ä»£ç ä¸º</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å³è¿”å›å€¼æ˜¯ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// NaN</span>
<span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// NaN, 3ä¸æ˜¯äºŒè¿›åˆ¶</span>
</code></pre></div><p>æ‰€ä»¥è¿™é“é¢˜çš„ç­”æ¡ˆæ˜¯ï¼š<code>['1', '2', '3'].map(parseInt)</code> // 1, NaN, NaN</p> <h2 id="_3-ä»€ä¹ˆæ˜¯é˜²æŠ–å’ŒèŠ‚æµ-æœ‰ä»€ä¹ˆåŒºåˆ«-å¦‚ä½•å®ç°"><a href="#_3-ä»€ä¹ˆæ˜¯é˜²æŠ–å’ŒèŠ‚æµ-æœ‰ä»€ä¹ˆåŒºåˆ«-å¦‚ä½•å®ç°" class="header-anchor">#</a> 3. ä»€ä¹ˆæ˜¯é˜²æŠ–å’ŒèŠ‚æµï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¦‚ä½•å®ç°</h2> <h3 id="é˜²æŠ–"><a href="#é˜²æŠ–" class="header-anchor">#</a> é˜²æŠ–</h3> <blockquote><p>è§¦å‘é«˜é¢‘äº‹ä»¶ånç§’å†…å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœnç§’å†…é«˜é¢‘äº‹ä»¶å†æ¬¡è¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡ç®—æ—¶é—´</p></blockquote> <ul><li>æ€è·¯ï¼š</li></ul> <blockquote><p>æ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶éƒ½å–æ¶ˆä¹‹å‰çš„å»¶æ—¶è°ƒç”¨æ–¹æ³•</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> timeout <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ ‡è®°ç”¨æ¥å­˜æ”¾å®šæ—¶å™¨çš„è¿”å›å€¼</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¯å½“ç”¨æˆ·è¾“å…¥çš„æ—¶å€™æŠŠå‰ä¸€ä¸ª setTimeout clear æ‰</span>
        timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// ç„¶ååˆåˆ›å»ºä¸€ä¸ªæ–°çš„ setTimeout, è¿™æ ·å°±èƒ½ä¿è¯è¾“å…¥å­—ç¬¦åçš„ interval é—´éš”å†…å¦‚æœè¿˜æœ‰å­—ç¬¦è¾“å…¥çš„è¯ï¼Œå°±ä¸ä¼šæ‰§è¡Œ fn å‡½æ•°</span>
          <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'é˜²æŠ–æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> inp <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'inp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    inp<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token function">debounce</span><span class="token punctuation">(</span>sayHi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é˜²æŠ–</span>
</code></pre></div><h3 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="header-anchor">#</a> èŠ‚æµ</h3> <blockquote><p>é«˜é¢‘äº‹ä»¶è§¦å‘ï¼Œä½†åœ¨nç§’å†…åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥èŠ‚æµä¼šç¨€é‡Šå‡½æ•°çš„æ‰§è¡Œé¢‘ç‡</p></blockquote> <ul><li>æ€è·¯ï¼š</li></ul> <blockquote><p>æ¯æ¬¡è§¦å‘äº‹ä»¶æ—¶éƒ½åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰ç­‰å¾…æ‰§è¡Œçš„å»¶æ—¶å‡½æ•°</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> canRun <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡é—­åŒ…ä¿å­˜ä¸€ä¸ªæ ‡è®°</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canRun<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">// åœ¨å‡½æ•°å¼€å¤´åˆ¤æ–­æ ‡è®°æ˜¯å¦ä¸ºtrueï¼Œä¸ä¸ºtrueåˆ™return</span>
        canRun <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// ç«‹å³è®¾ç½®ä¸ºfalse</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// å°†å¤–éƒ¨ä¼ å…¥çš„å‡½æ•°çš„æ‰§è¡Œæ”¾åœ¨setTimeoutä¸­</span>
          <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// æœ€ååœ¨setTimeoutæ‰§è¡Œå®Œæ¯•åå†æŠŠæ ‡è®°è®¾ç½®ä¸ºtrue(å…³é”®)è¡¨ç¤ºå¯ä»¥æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯äº†ã€‚å½“å®šæ—¶å™¨æ²¡æœ‰æ‰§è¡Œçš„æ—¶å€™æ ‡è®°æ°¸è¿œæ˜¯falseï¼Œåœ¨å¼€å¤´è¢«returnæ‰</span>
          canRun <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token function">throttle</span><span class="token punctuation">(</span>sayHi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_4-ä»‹ç»ä¸‹-setã€mapã€weakset-å’Œ-weakmap-çš„åŒºåˆ«"><a href="#_4-ä»‹ç»ä¸‹-setã€mapã€weakset-å’Œ-weakmap-çš„åŒºåˆ«" class="header-anchor">#</a> 4. ä»‹ç»ä¸‹ Setã€Mapã€WeakSet å’Œ WeakMap çš„åŒºåˆ«</h2> <p><a href="https://younglele.cn/es6-set-and-map/" target="_blank" rel="noopener noreferrer">è¯¦æƒ…ğŸ”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_5-es5-es6-çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#_5-es5-es6-çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«" class="header-anchor">#</a> 5. ES5/ES6 çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«</h2> <ol><li><p>ES5 å’Œ ES6 å­ç±» <code>this</code> ç”Ÿæˆé¡ºåºä¸åŒã€‚ES5 çš„ç»§æ‰¿å…ˆç”Ÿæˆäº†å­ç±»å®ä¾‹ï¼Œå†è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¿®é¥°å­ç±»å®ä¾‹ï¼ŒES6 çš„ç»§æ‰¿å…ˆç”Ÿæˆçˆ¶ç±»å®ä¾‹ï¼Œå†è°ƒç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®é¥°çˆ¶ç±»å®ä¾‹ã€‚è¿™ä¸ªå·®åˆ«ä½¿å¾— ES6 å¯ä»¥ç»§æ‰¿å†…ç½®å¯¹è±¡ã€‚</p></li> <li><p>åŒºåˆ«äºES5çš„ç»§æ‰¿ï¼ŒES6çš„ç»§æ‰¿å®ç°åœ¨äºä½¿ç”¨superå…³é”®å­—è°ƒç”¨çˆ¶ç±»ï¼Œåè§‚ES5æ˜¯é€šè¿‡callæˆ–è€…applyå›è°ƒæ–¹æ³•è°ƒç”¨çˆ¶ç±»ã€‚</p></li> <li><p>ES6å­ç±»å¯ä»¥ç›´æ¥é€šè¿‡ <strong>proto</strong> å¯»å€åˆ°çˆ¶ç±»ã€‚è€Œé€šè¿‡ ES5 çš„æ–¹å¼ï¼ŒSub.<strong>proto</strong> === Function.prototype</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Super</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Sub</span> <span class="token keyword">extends</span> <span class="token class-name">Super</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> sub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Sub<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Super<span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Sub<span class="token punctuation">;</span>

<span class="token keyword">var</span> sub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Sub<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
</code></pre></div><h2 id="_6-settimeoutã€promiseã€async-await-çš„åŒºåˆ«"><a href="#_6-settimeoutã€promiseã€async-await-çš„åŒºåˆ«" class="header-anchor">#</a> 6. setTimeoutã€Promiseã€Async/Await çš„åŒºåˆ«</h2> <p>ä¸»è¦æ˜¯æ¥è€ƒå¯Ÿä¸‰è€…åœ¨äº‹ä»¶å¾ªç¯ä¸­çš„åŒºåˆ«ã€‚äº‹ä»¶å¾ªç¯ä¸­åˆ†ä¸º<strong>å®è§‚ä»»åŠ¡é˜Ÿåˆ—</strong>å’Œ<strong>å¾®è§‚ä»»åŠ¡é˜Ÿåˆ—</strong>ã€‚</p> <p>JSæ˜¯å•çº¿ç¨‹çš„ï¼Œå¯¹äºå¼‚æ­¥æ“ä½œåªèƒ½å…ˆå°†å…¶æ”¾åœ¨ä¸€è¾¹ï¼ŒæŒ‰ç…§æŸç§è§„åˆ™æŒ‰å…ˆåé¡ºåºæ”¾åœ¨æŸä¸ªå®¹å™¨ä¸­ï¼ˆå…¶å®å°±æ˜¯å®è§‚ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®è§‚ä»»åŠ¡é˜Ÿåˆ—ï¼‰ã€‚å…ˆå¤„ç†åŒæ­¥ä»»åŠ¡ï¼Œå†å¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚å¼‚æ­¥ä»»åŠ¡åˆ†ä¸ºå®è§‚ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®è§‚ä»»åŠ¡é˜Ÿåˆ—ã€‚</p> <p><strong>å®è§‚ä»»åŠ¡</strong>æœ‰</p> <ul><li>scriptï¼ˆæ•´ä½“ä»£ç ï¼‰</li> <li>setTimeout</li> <li>setInterval</li> <li>I/O</li> <li>UIäº¤äº’äº‹ä»¶</li> <li>postMessage</li> <li>MessageChannel</li> <li>setImmediate(Node.js ç¯å¢ƒ)</li></ul> <p><strong>å¾®è§‚ä»»åŠ¡</strong>æœ‰</p> <ul><li>Promise.then</li> <li>MutaionObserver</li> <li>process.nextTick(Node.js ç¯å¢ƒ)</li> <li>async/awaitå®é™…ä¸Šæ˜¯promise+generatorçš„è¯­æ³•ç³–ï¼Œä¹Ÿå°±æ˜¯promiseï¼Œä¹Ÿå°±æ˜¯å¾®è§‚ä»»åŠ¡</li></ul> <p><strong>æ‰§è¡Œé¡ºåºæ˜¯</strong>ï¼š<strong>åŒæ­¥ä»»åŠ¡ç»“æŸåï¼Œå…ˆå¤„ç†å¾®è§‚ä»»åŠ¡åå¤„ç†å®è§‚ä»»åŠ¡</strong></p> <h3 id="settimeout"><a href="#settimeout" class="header-anchor">#</a> setTimeout</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span> <span class="token comment">//1. æ‰“å° script start</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span> <span class="token comment">// 4. æ‰“å° settimeout</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 2. è°ƒç”¨ setTimeout å‡½æ•°ï¼Œå¹¶å®šä¹‰å…¶å®Œæˆåæ‰§è¡Œçš„å›è°ƒå‡½æ•°</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span> <span class="token comment">//3. æ‰“å° script start</span>
<span class="token comment">// è¾“å‡ºé¡ºåºï¼šscript start-&gt;script end-&gt;setTimeout</span>
</code></pre></div><p>æ³¨ï¼šå°±ç®—è®¾ç½®çš„æ˜¯<strong>0</strong>ç§’åæ‰§è¡Œï¼Œè¾“å‡ºé¡ºåºä¹Ÿä¸ä¼šå˜</p> <h3 id="promise"><a href="#promise" class="header-anchor">#</a> Promise</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span> <span class="token comment">// 1.åŒæ­¥ä»»åŠ¡</span>
<span class="token keyword">let</span> promise1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span> <span class="token comment">// 2. åŒæ­¥ä»»åŠ¡</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'resolve end'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 3.åŒæ­¥ä»»åŠ¡</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1 end'</span><span class="token punctuation">)</span> <span class="token comment">// 4. åŒæ­¥ä»»åŠ¡</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span> <span class="token comment">// 6. å¾®è§‚ä»»åŠ¡</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span> <span class="token comment">// 7. å®è§‚ä»»åŠ¡</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span> <span class="token comment">// 5. åŒæ­¥ä»»åŠ¡</span>
<span class="token comment">// è¾“å‡ºé¡ºåºï¼š script start -&gt; promise1 -&gt; resolve end -&gt; promise1 end -&gt; script end -&gt;  promise2 -&gt; setTimeout</span>
</code></pre></div><p>Promiseæœ¬èº«æ˜¯<strong>åŒæ­¥çš„ç«‹å³æ‰§è¡Œå‡½æ•°</strong>ï¼Œè€Œ<code>Promise.then()</code>æ‰æ˜¯å¾®è§‚ä»»åŠ¡</p> <h3 id="async-await"><a href="#async-await" class="header-anchor">#</a> Async/Await</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2 start'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">async3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">async3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async3'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span>

<span class="token comment">// è¾“å‡ºé¡ºåº script start -&gt; async1 start -&gt; async2 start -&gt; async3 -&gt; script end -&gt; async2 end -&gt; async1 end</span>
</code></pre></div><p>asyncè¿”å›ä¸€ä¸ªPromiseå‡½æ•° ï¼Œé‡åˆ°awaitä¼šç«‹å³æ‰§è¡Œawaitåé¢çš„ä»£ç ã€‚è€Œawaitä¸‹é¢çš„ä»£ç ä¼šæ”¾åœ¨å¾®è§‚ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</p> <p>awaitçš„å«ä¹‰ä¸ºç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯ async å‡½æ•°éœ€è¦ç­‰å¾…awaitåçš„å‡½æ•°æ‰§è¡Œå®Œæˆå¹¶ä¸”æœ‰äº†è¿”å›ç»“æœï¼ˆPromiseå¯¹è±¡ï¼‰ä¹‹åï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚awaité€šè¿‡è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡æ¥å®ç°åŒæ­¥çš„æ•ˆæœã€‚</p> <h2 id="_7-async-await-å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥"><a href="#_7-async-await-å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥" class="header-anchor">#</a> 7. Async/Await å¦‚ä½•é€šè¿‡åŒæ­¥çš„æ–¹å¼å®ç°å¼‚æ­¥</h2> <p>å ä½</p> <h2 id="_8-å¼‚æ­¥ç¬”è¯•é¢˜"><a href="#_8-å¼‚æ­¥ç¬”è¯•é¢˜" class="header-anchor">#</a> 8. å¼‚æ­¥ç¬”è¯•é¢˜</h2> <blockquote><p>è¯·å†™å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœ</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿è¡Œç»“æœï¼šscript start -&gt; async1 start -&gt; async2 -&gt; promise1 -&gt; script end -&gt; async1 end -&gt; promise2 -&gt;  setTimeout</p> <p>å…ˆå¤§ä½“çœ‹ä¸‹ä»£ç ï¼š</p> <p>ä»ä¸Šå¾€ä¸‹çœ‹ï¼Œå…ˆèµ°åŒæ­¥é˜Ÿåˆ—ï¼Œå†èµ°å¼‚æ­¥é˜Ÿåˆ—ï¼ˆåŒ…å«å¾®è§‚ä»»åŠ¡é˜Ÿåˆ—å’Œå®è§‚ä»»åŠ¡é˜Ÿåˆ—ï¼‰ã€‚</p> <p>åŒæ­¥é˜Ÿåˆ—ï¼šscript start â†’ async1 start â†’ async2 â†’ promise1 â†’ script end</p> <p>å¼‚æ­¥é˜Ÿåˆ—ï¼šåŒ…æ‹¬å¾®è§‚ä»»åŠ¡å’Œå®è§‚ä»»åŠ¡ã€‚</p> <p>å¾®è§‚ä»»åŠ¡ï¼šasync1 end â†’ promise2</p> <p>å®è§‚ä»»åŠ¡: setTimeout â†’</p> <h2 id="_9-ç®—æ³•æ‰‹å†™é¢˜"><a href="#_9-ç®—æ³•æ‰‹å†™é¢˜" class="header-anchor">#</a> 9. ç®—æ³•æ‰‹å†™é¢˜</h2> <blockquote><p>å·²çŸ¥å¦‚ä¸‹æ•°ç»„ï¼š</p> <p>var arr = [ [1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14] ] ] ], 10];</p> <p>ç¼–å†™ä¸€ä¸ªç¨‹åºå°†æ•°ç»„æ‰å¹³åŒ–å»å¹¶é™¤å…¶ä¸­é‡å¤éƒ¨åˆ†æ•°æ®ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå‡åºä¸”ä¸é‡å¤çš„æ•°ç»„</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token operator">-</span>b<span class="token punctuation">)</span>
</code></pre></div><p><code>arr.flat(Infinity)</code>ç”¨äºå°†åµŒå¥—çš„æ•°ç»„æ‹‰å¹³</p> <p><code>new Set(arr)</code>ç”¨äºå»é‡ï¼Œè¿”å›ä¸€ä¸ªç±»æ•°ç»„çš„Setæ•°æ®ç»“æ„</p> <p><code>Array.from(set)</code>å°†ä¸€ä¸ªç±»æ•°ç»„çš„æ•°æ®ç»“æ„è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„</p> <p><code>sort</code>ç”¨äºæ•°ç»„çš„å¤§å°æ’åº</p> <p><img src="https://lepicgo.oss-cn-beijing.aliyuncs.com/img/array.jpg" alt="array"></p> <h2 id="_10-js-å¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹"><a href="#_10-js-å¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹" class="header-anchor">#</a> 10. JS å¼‚æ­¥è§£å†³æ–¹æ¡ˆçš„å‘å±•å†ç¨‹ä»¥åŠä¼˜ç¼ºç‚¹</h2> <h3 id="å›è°ƒå‡½æ•°-callback"><a href="#å›è°ƒå‡½æ•°-callback" class="header-anchor">#</a> å›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// callback å‡½æ•°ä½“</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>ç¼ºç‚¹</strong>ï¼š<strong>å›è°ƒåœ°ç‹±ï¼Œä¸èƒ½ç”¨ try catch æ•è·é”™è¯¯ï¼Œä¸èƒ½ return</strong></p> <p>å›è°ƒåœ°ç‹±çš„æ ¹æœ¬é—®é¢˜åœ¨äºï¼š</p> <ul><li>ç¼ºä¹é¡ºåºæ€§ï¼š å›è°ƒåœ°ç‹±å¯¼è‡´çš„è°ƒè¯•å›°éš¾ï¼Œå’Œå¤§è„‘çš„æ€ç»´æ–¹å¼ä¸ç¬¦</li> <li>åµŒå¥—å‡½æ•°å­˜åœ¨è€¦åˆæ€§ï¼Œä¸€æ—¦æœ‰æ‰€æ”¹åŠ¨ï¼Œå°±ä¼šç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œå³ï¼ˆ<strong>æ§åˆ¶åè½¬</strong>ï¼‰</li> <li>åµŒå¥—å‡½æ•°è¿‡å¤šçš„å¤šè¯ï¼Œå¾ˆéš¾å¤„ç†é”™è¯¯</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// callback å‡½æ•°ä½“</span>
    <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX2'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// callback å‡½æ•°ä½“</span>
        <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX3'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// callback å‡½æ•°ä½“</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>ä¼˜ç‚¹ï¼šè§£å†³äº†åŒæ­¥çš„é—®é¢˜</strong>ï¼ˆåªè¦æœ‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼Œåé¢çš„ä»»åŠ¡éƒ½å¿…é¡»æ’é˜Ÿç­‰ç€ï¼Œä¼šæ‹–å»¶æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œã€‚ï¼‰</p> <h3 id="promise-2"><a href="#promise-2" class="header-anchor">#</a> Promise</h3> <p>Promiseå°±æ˜¯ä¸ºäº†è§£å†³callbackçš„é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚</p> <p>Promise å®ç°äº†é“¾å¼è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡ then åè¿”å›çš„éƒ½æ˜¯ä¸€ä¸ªå…¨æ–° Promiseï¼Œå¦‚æœæˆ‘ä»¬åœ¨ then ä¸­ return ï¼Œreturn çš„ç»“æœä¼šè¢« Promise.resolve() åŒ…è£…</p> <p><strong>ä¼˜ç‚¹</strong>ï¼š<strong>è§£å†³äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX1'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ“ä½œé€»è¾‘</span>
      <span class="token keyword">return</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ“ä½œé€»è¾‘</span>
      <span class="token keyword">return</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX3'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ“ä½œé€»è¾‘</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>ç¼ºç‚¹</strong>ï¼š<strong>æ— æ³•å–æ¶ˆ Promise ï¼Œé”™è¯¯éœ€è¦é€šè¿‡å›è°ƒå‡½æ•°æ¥æ•è·</strong></p> <h3 id="generator"><a href="#generator" class="header-anchor">#</a> Generator</h3> <p><strong>ç‰¹ç‚¹ï¼šå¯ä»¥æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ</strong>ï¼Œå¯ä»¥é…åˆ co å‡½æ•°åº“ä½¿ç”¨</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX2'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'XXX3'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> it <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> result1 <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> result2 <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> result3 <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="async-await-2"><a href="#async-await-2" class="header-anchor">#</a> Async/await</h3> <p>asyncã€await æ˜¯å¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ</p> <p><strong>ä¼˜ç‚¹æ˜¯</strong>ï¼š<strong>ä»£ç æ¸…æ™°ï¼Œä¸ç”¨åƒ Promise å†™ä¸€å¤§å † then é“¾ï¼Œå¤„ç†äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜</strong></p> <p><strong>ç¼ºç‚¹ï¼šawait å°†å¼‚æ­¥ä»£ç æ”¹é€ æˆåŒæ­¥ä»£ç ï¼Œå¦‚æœå¤šä¸ªå¼‚æ­¥æ“ä½œæ²¡æœ‰ä¾èµ–æ€§è€Œä½¿ç”¨ await ä¼šå¯¼è‡´æ€§èƒ½ä¸Šçš„é™ä½ã€‚</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä»¥ä¸‹ä»£ç æ²¡æœ‰ä¾èµ–æ€§çš„è¯ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ Promise.all çš„æ–¹å¼</span>
  <span class="token comment">// å¦‚æœæœ‰ä¾èµ–æ€§çš„è¯ï¼Œå…¶å®å°±æ˜¯è§£å†³å›è°ƒåœ°ç‹±çš„ä¾‹å­äº†</span>
  <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'XXX1'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'XXX2'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'XXX3'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä½¿ç”¨ <code>await</code> çš„ä¾‹å­ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">let</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  a <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token keyword">await</span> <span class="token number">10</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '2' 10</span>
<span class="token punctuation">}</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
a<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// -&gt; '1' 1</span>
</code></pre></div><p>å¯¹äºä»¥ä¸Šä»£ç ä½ å¯èƒ½ä¼šæœ‰ç–‘æƒ‘ï¼Œè®©æˆ‘æ¥è§£é‡Šä¸‹åŸå› </p> <ul><li>é¦–å…ˆå‡½æ•° <code>b</code> å…ˆæ‰§è¡Œï¼Œåœ¨æ‰§è¡Œåˆ° <code>await 10</code> ä¹‹å‰å˜é‡ <code>a</code> è¿˜æ˜¯ 0ï¼Œå› ä¸º <code>await</code> å†…éƒ¨å®ç°äº† <code>generator</code> ï¼Œ<strong><code>generator</code> ä¼šä¿ç•™å †æ ˆä¸­ä¸œè¥¿ï¼Œæ‰€ä»¥è¿™æ—¶å€™ <code>a = 0</code> è¢«ä¿å­˜äº†ä¸‹æ¥</strong></li> <li>å› ä¸º <code>await</code> æ˜¯å¼‚æ­¥æ“ä½œï¼Œåæ¥çš„è¡¨è¾¾å¼ä¸è¿”å› <code>Promise</code> çš„è¯ï¼Œå°±ä¼šåŒ…è£…æˆ <code>Promise.reslove(è¿”å›å€¼)</code>ï¼Œç„¶åä¼šå»æ‰§è¡Œå‡½æ•°å¤–çš„åŒæ­¥ä»£ç </li> <li>åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•åå¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»£ç ï¼Œå°†ä¿å­˜ä¸‹æ¥çš„å€¼æ‹¿å‡ºæ¥ä½¿ç”¨ï¼Œè¿™æ—¶å€™ <code>a = 0 + 10</code></li></ul> <p>ä¸Šè¿°è§£é‡Šä¸­æåˆ°äº† <code>await</code> å†…éƒ¨å®ç°äº† <code>generator</code>ï¼Œå…¶å® <code>await</code> å°±æ˜¯ <code>generator</code> åŠ ä¸Š <code>Promise</code>çš„è¯­æ³•ç³–ï¼Œä¸”å†…éƒ¨å®ç°äº†è‡ªåŠ¨æ‰§è¡Œ <code>generator</code>ã€‚å¦‚æœä½ ç†Ÿæ‚‰ co çš„è¯ï¼Œå…¶å®è‡ªå·±å°±å¯ä»¥å®ç°è¿™æ ·çš„è¯­æ³•ç³–ã€‚</p> <h2 id="_11-promise-æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œ-é‚£ä¹ˆ-then-æ–¹æ³•å‘¢"><a href="#_11-promise-æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œ-é‚£ä¹ˆ-then-æ–¹æ³•å‘¢" class="header-anchor">#</a> 11. Promise æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆ then æ–¹æ³•å‘¢</h2> <p>ç”±ä¸‹å›¾å¯çŸ¥ï¼Œ<code>Promise</code>æ„é€ å‡½æ•°æ˜¯åŒæ­¥çš„ï¼Œ<code>then</code>æ–¹æ³•æ˜¯å¼‚æ­¥çš„</p> <ul><li><code>Promise.then</code>æ˜¯å¾®è§‚ä»»åŠ¡</li> <li><code>setTimeout</code>æ˜¯å®è§‚ä»»åŠ¡</li> <li>æ‰§è¡Œé¡ºåºï¼šåŒæ­¥ -&gt; å¾®è§‚ -&gt; å®è§‚</li></ul> <p><img src="https://lepicgo.oss-cn-beijing.aliyuncs.com/img/promise.png" alt="promise"></p> <h2 id="_12-å¦‚ä½•å®ç°ä¸€ä¸ª-new"><a href="#_12-å¦‚ä½•å®ç°ä¸€ä¸ª-new" class="header-anchor">#</a> 12. å¦‚ä½•å®ç°ä¸€ä¸ª new</h2> <blockquote><p><code>new</code>è¿ç®—ç¬¦çš„å·¥ä½œåŸç†</p></blockquote> <ol><li>ä¸€ä¸ªæ–°å¯¹è±¡è¢«åˆ›å»ºï¼Œå®ƒç»§æ‰¿è‡ªæ„é€ å‡½æ•°çš„<code>prototype</code>ï¼Œ<code>foo.prototype</code></li> <li>æ„é€ å‡½æ•°è¢«æ‰§è¡Œï¼Œæ‰§è¡Œçš„æ—¶å€™ï¼Œç›¸åº”çš„å‚æ•°ä¼šè¢«ä¼ å…¥ï¼ŒåŒæ—¶ä¸Šä¸‹æ–‡ï¼ˆthisï¼‰ä¼šè¢«æŒ‡å®šä¸ºè¿™ä¸ªæ–°çš„å®ä¾‹ã€‚<code>new foo</code>å’Œ<code>new foo()</code>ç›¸åŒï¼Œåªèƒ½ç”¨åœ¨ä¸ä¼ é€’ä»»ä½•å‚æ•°çš„æƒ…å†µã€‚</li> <li>å¦‚æœæ„é€ å‡½æ•°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šå–ä»£è¿”å›å‡ºæ¥çš„ç»“æœã€‚å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å‡ºæ¥å¯¹è±¡ï¼Œé‚£ä¹ˆnewå‡ºæ¥çš„ç»“æœä¸ºæ­¥éª¤1åˆ›å»ºçš„ç»“æœã€‚</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> ret <span class="token operator">:</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_13-react-ä¸­-setstate-ä»€ä¹ˆæ—¶å€™æ˜¯åŒæ­¥çš„-ä»€ä¹ˆæ—¶å€™æ˜¯å¼‚æ­¥çš„"><a href="#_13-react-ä¸­-setstate-ä»€ä¹ˆæ—¶å€™æ˜¯åŒæ­¥çš„-ä»€ä¹ˆæ—¶å€™æ˜¯å¼‚æ­¥çš„" class="header-anchor">#</a> 13. React ä¸­ setState ä»€ä¹ˆæ—¶å€™æ˜¯åŒæ­¥çš„ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯å¼‚æ­¥çš„</h2> <p>åœ¨Reactä¸­ï¼Œ<strong>å¦‚æœæ˜¯ç”±Reactå¼•å‘çš„äº‹ä»¶å¤„ç†ï¼ˆæ¯”å¦‚é€šè¿‡onClickå¼•å‘çš„äº‹ä»¶å¤„ç†ï¼‰ï¼Œè°ƒç”¨setStateä¸ä¼šåŒæ­¥æ›´æ–°this.stateï¼Œé™¤æ­¤ä¹‹å¤–çš„setStateè°ƒç”¨ä¼šåŒæ­¥æ‰§è¡Œthis.state</strong>ã€‚æ‰€è°“â€œé™¤æ­¤ä¹‹å¤–â€ï¼ŒæŒ‡çš„æ˜¯ç»•è¿‡Reacté€šè¿‡addEventListenerç›´æ¥æ·»åŠ çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿˜æœ‰é€šè¿‡setTimeout/setIntervaläº§ç”Ÿçš„å¼‚æ­¥è°ƒç”¨ã€‚</p> <p>**åŸå› ï¼š**åœ¨Reactçš„setStateå‡½æ•°å®ç°ä¸­ï¼Œä¼šæ ¹æ®ä¸€ä¸ªå˜é‡isBatchingUpdatesåˆ¤æ–­æ˜¯ç›´æ¥æ›´æ–°this.stateè¿˜æ˜¯æ”¾åˆ°é˜Ÿåˆ—ä¸­å›å¤´å†è¯´ï¼Œè€ŒisBatchingUpdatesé»˜è®¤æ˜¯falseï¼Œä¹Ÿå°±è¡¨ç¤ºsetStateä¼šåŒæ­¥æ›´æ–°this.stateï¼Œä½†æ˜¯ï¼Œ<strong>æœ‰ä¸€ä¸ªå‡½æ•°batchedUpdatesï¼Œè¿™ä¸ªå‡½æ•°ä¼šæŠŠisBatchingUpdatesä¿®æ”¹ä¸ºtrueï¼Œè€Œå½“Reactåœ¨è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°ä¹‹å‰å°±ä¼šè°ƒç”¨è¿™ä¸ªbatchedUpdatesï¼Œé€ æˆçš„åæœï¼Œå°±æ˜¯ç”±Reactæ§åˆ¶çš„äº‹ä»¶å¤„ç†è¿‡ç¨‹setStateä¸ä¼šåŒæ­¥æ›´æ–°this.state</strong>ã€‚</p> <p>è¿™é‡Œæ‰€è¯´çš„åŒæ­¥å¼‚æ­¥ï¼Œ å¹¶ä¸æ˜¯çœŸæ­£çš„åŒæ­¥å¼‚æ­¥ï¼Œ å®ƒè¿˜æ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚</p> <p>è¿™é‡Œçš„å¼‚æ­¥æŒ‡çš„æ˜¯å¤šä¸ªstateä¼šåˆæˆåˆ°ä¸€èµ·è¿›è¡Œæ‰¹é‡æ›´æ–°ã€‚</p> <h2 id="_14-react-setstate-ç¬”è¯•é¢˜-ä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆ"><a href="#_14-react-setstate-ç¬”è¯•é¢˜-ä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆ" class="header-anchor">#</a> 14. React setState ç¬”è¯•é¢˜ï¼Œä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆ</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      val<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>val<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ç¬¬ 1 æ¬¡ log</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>val<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ç¬¬ 2 æ¬¡ log</span>

    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>val<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç¬¬ 3 æ¬¡ log</span>

      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>val<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç¬¬ 4 æ¬¡ log</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>ç­”æ¡ˆä¸ºï¼š0ï¼Œ0ï¼Œ2ï¼Œ3</p> <ol><li><p>ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡éƒ½æ˜¯åœ¨ <code>react</code> è‡ªèº«ç”Ÿå‘½å‘¨æœŸå†…ï¼Œè§¦å‘æ—¶ <code>isBatchingUpdates</code> ä¸º<code>true</code>ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šç›´æ¥æ‰§è¡Œæ›´æ–° stateï¼Œè€Œæ˜¯åŠ å…¥äº† <code>dirtyComponents</code>ï¼Œæ‰€ä»¥æ‰“å°æ—¶è·å–çš„éƒ½æ˜¯æ›´æ–°å‰çš„çŠ¶æ€ 0ã€‚</p></li> <li><p>ä¸¤æ¬¡ setState æ—¶ï¼Œè·å–åˆ° <code>this.state.val</code> éƒ½æ˜¯ 0ï¼Œæ‰€ä»¥æ‰§è¡Œæ—¶éƒ½æ˜¯å°† 0 è®¾ç½®æˆ 1ï¼Œåœ¨ react å†…éƒ¨ä¼šè¢«åˆå¹¶æ‰ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚è®¾ç½®å®Œæˆå <code>state.val</code> å€¼ä¸º 1ã€‚</p></li> <li><p><code>setTimeout</code> ä¸­çš„ä»£ç ï¼Œè§¦å‘æ—¶<code>isBatchingUpdates</code> ä¸º falseï¼Œæ‰€ä»¥èƒ½å¤Ÿç›´æ¥è¿›è¡Œæ›´æ–°ï¼Œæ‰€ä»¥è¿ç€è¾“å‡º 2ï¼Œ3ã€‚</p></li></ol> <p><code>isBatchingUpdates</code> é»˜è®¤å€¼ä¸º falseï¼Œå½“ react è‡ªèº«çš„äº‹ä»¶å¤„ç†å‡½æ•°æˆ– react ç”Ÿå‘½å‘¨æœŸè§¦å‘æ—¶ï¼Œ<code>isBatchingUpdates</code> ä¼šè¢«èµ‹å€¼ä¸º trueï¼Œå½“æ›´æ–°å®Œæˆæ—¶åˆä¼šè¢«å¤åŸä¸º falseã€‚</p> <h2 id="_15-æœ‰ä»¥ä¸‹-3-ä¸ªåˆ¤æ–­æ•°ç»„çš„æ–¹æ³•-è¯·åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£"><a href="#_15-æœ‰ä»¥ä¸‹-3-ä¸ªåˆ¤æ–­æ•°ç»„çš„æ–¹æ³•-è¯·åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£" class="header-anchor">#</a> 15. æœ‰ä»¥ä¸‹ 3 ä¸ªåˆ¤æ–­æ•°ç»„çš„æ–¹æ³•ï¼Œè¯·åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å’Œä¼˜åŠ£</h2> <blockquote><p>Object.prototype.toString.call() ã€ instanceof ä»¥åŠ Array.isArray()</p></blockquote> <h3 id="_1-object-prototype-tostring-call"><a href="#_1-object-prototype-tostring-call" class="header-anchor">#</a> 1. Object.prototype.toString.call()</h3> <p>æ¯ä¸€ä¸ªç»§æ‰¿ Object çš„å¯¹è±¡éƒ½æœ‰ <code>toString</code> æ–¹æ³•ï¼Œå¦‚æœ <code>toString</code> æ–¹æ³•æ²¡æœ‰é‡å†™çš„è¯ï¼Œä¼šè¿”å› <code>[Object type]</code>ï¼Œå…¶ä¸­ type ä¸ºå¯¹è±¡çš„ç±»å‹ã€‚ä½†å½“é™¤äº† Object ç±»å‹çš„å¯¹è±¡å¤–ï¼Œå…¶ä»–ç±»å‹ç›´æ¥ä½¿ç”¨ <code>toString</code> æ–¹æ³•æ—¶ï¼Œä¼šç›´æ¥è¿”å›éƒ½æ˜¯å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨callæˆ–è€…applyæ–¹æ³•æ¥æ”¹å˜toStringæ–¹æ³•çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> an <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Hello'</span><span class="token punctuation">,</span><span class="token string">'An'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
an<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;Hello,An&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>an<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[object Array]&quot;</span>
</code></pre></div><p>è¿™ç§æ–¹æ³•å¯¹äºæ‰€æœ‰åŸºæœ¬çš„æ•°æ®ç±»å‹éƒ½èƒ½è¿›è¡Œåˆ¤æ–­ï¼Œå³ä½¿æ˜¯ null å’Œ undefined ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'An'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object String]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Number]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Symbol]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Null]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Undefined]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Function]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'An'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Object]&quot;</span>
</code></pre></div><p><code>Object.prototype.toString.call()</code> å¸¸ç”¨äºåˆ¤æ–­æµè§ˆå™¨å†…ç½®å¯¹è±¡æ—¶ã€‚</p> <h3 id="_2-instanceof"><a href="#_2-instanceof" class="header-anchor">#</a> 2. instanceof</h3> <p><code>instanceof</code> çš„å†…éƒ¨æœºåˆ¶æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„åŸå‹é“¾ä¸­æ˜¯ä¸æ˜¯èƒ½æ‰¾åˆ°ç±»å‹çš„ <code>prototype</code>ã€‚</p> <p>ä½¿ç”¨ <code>instanceof</code>åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºæ•°ç»„ï¼Œ<code>instanceof</code> ä¼šåˆ¤æ–­è¿™ä¸ªå¯¹è±¡çš„åŸå‹é“¾ä¸Šæ˜¯å¦ä¼šæ‰¾åˆ°å¯¹åº”çš„ <code>Array</code> çš„åŸå‹ï¼Œæ‰¾åˆ°è¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>ä½† <code>instanceof</code> åªèƒ½ç”¨æ¥åˆ¤æ–­å¯¹è±¡ç±»å‹ï¼ŒåŸå§‹ç±»å‹ä¸å¯ä»¥ã€‚å¹¶ä¸”æ‰€æœ‰å¯¹è±¡ç±»å‹ instanceof Object éƒ½æ˜¯ trueã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="_3-array-isarray"><a href="#_3-array-isarray" class="header-anchor">#</a> 3. Array.isArray()</h3> <ul><li><p>åŠŸèƒ½ï¼šç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæ•°ç»„</p></li> <li><p>instanceof ä¸ isArray</p> <p>å½“æ£€æµ‹Arrayå®ä¾‹æ—¶ï¼Œ<code>Array.isArray</code> ä¼˜äº <code>instanceof</code> ï¼Œå› ä¸º <code>Array.isArray</code> å¯ä»¥æ£€æµ‹å‡º <code>iframes</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
xArray <span class="token operator">=</span> window<span class="token punctuation">.</span>frames<span class="token punctuation">[</span>window<span class="token punctuation">.</span>frames<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Array<span class="token punctuation">;</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">xArray</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3]</span>

<span class="token comment">// Correctly checking for Array</span>
Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// true</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// Considered harmful, because doesn't work though iframes</span>
arr <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div></li> <li><p><code>Array.isArray()</code> ä¸ <code>Object.prototype.toString.call()</code></p> <p><code>Array.isArray()</code>æ˜¯ES5æ–°å¢çš„æ–¹æ³•ï¼Œå½“ä¸å­˜åœ¨ <code>Array.isArray()</code> ï¼Œå¯ä»¥ç”¨ <code>Object.prototype.toString.call()</code> å®ç°ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span>isArray<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Array<span class="token punctuation">.</span><span class="token function-variable function">isArray</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Array]'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="_16-ä»‹ç»ä¸‹è§‚å¯Ÿè€…æ¨¡å¼å’Œè®¢é˜…-å‘å¸ƒæ¨¡å¼çš„åŒºåˆ«-å„è‡ªé€‚ç”¨äºä»€ä¹ˆåœºæ™¯"><a href="#_16-ä»‹ç»ä¸‹è§‚å¯Ÿè€…æ¨¡å¼å’Œè®¢é˜…-å‘å¸ƒæ¨¡å¼çš„åŒºåˆ«-å„è‡ªé€‚ç”¨äºä»€ä¹ˆåœºæ™¯" class="header-anchor">#</a> 16. ä»‹ç»ä¸‹è§‚å¯Ÿè€…æ¨¡å¼å’Œè®¢é˜…-å‘å¸ƒæ¨¡å¼çš„åŒºåˆ«ï¼Œå„è‡ªé€‚ç”¨äºä»€ä¹ˆåœºæ™¯</h2> <p>è§‚å¯Ÿè€…æ¨¡å¼ä¸­ä¸»ä½“å’Œè§‚å¯Ÿè€…æ˜¯äº’ç›¸æ„ŸçŸ¥çš„ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼æ˜¯å€ŸåŠ©ç¬¬ä¸‰æ–¹æ¥å®ç°è°ƒåº¦çš„ï¼Œå‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´äº’ä¸æ„ŸçŸ¥</p> <ol><li>å‘å¸ƒ-è®¢é˜…æ¨¡å¼å°±å¥½åƒæŠ¥ç¤¾ï¼Œ é‚®å±€å’Œä¸ªäººçš„å…³ç³»ï¼ŒæŠ¥çº¸çš„è®¢é˜…å’Œåˆ†å‘æ˜¯ç”±é‚®å±€æ¥å®Œæˆçš„ã€‚æŠ¥ç¤¾åªè´Ÿè´£å°†æŠ¥çº¸å‘é€ç»™é‚®å±€ã€‚</li> <li>è§‚å¯Ÿè€…æ¨¡å¼å°±å¥½åƒ ä¸ªä½“å¥¶å†œå’Œä¸ªäººçš„å…³ç³»ã€‚å¥¶å†œè´Ÿè´£ç»Ÿè®¡æœ‰å¤šå°‘äººè®¢äº†äº§å“ï¼Œæ‰€ä»¥ä¸ªäººéƒ½ä¼šæœ‰ä¸€ä¸ªç›¸åŒæ‹¿ç‰›å¥¶çš„æ–¹æ³•ã€‚å¥¶å†œæœ‰æ–°å¥¶äº†å°±è´Ÿè´£è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</li></ol> <h2 id="_17-å…¨å±€ä½œç”¨åŸŸä¸­-ç”¨-const-å’Œ-let-å£°æ˜çš„å˜é‡ä¸åœ¨-window-ä¸Š-é‚£åˆ°åº•åœ¨å“ªé‡Œ-å¦‚ä½•å»è·å–"><a href="#_17-å…¨å±€ä½œç”¨åŸŸä¸­-ç”¨-const-å’Œ-let-å£°æ˜çš„å˜é‡ä¸åœ¨-window-ä¸Š-é‚£åˆ°åº•åœ¨å“ªé‡Œ-å¦‚ä½•å»è·å–" class="header-anchor">#</a> 17. å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œç”¨ const å’Œ let å£°æ˜çš„å˜é‡ä¸åœ¨ window ä¸Šï¼Œé‚£åˆ°åº•åœ¨å“ªé‡Œï¼Ÿå¦‚ä½•å»è·å–</h2> <p>åœ¨ES5ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§å’Œå…¨å±€å˜é‡æ˜¯ç­‰ä»·çš„ï¼Œvar å‘½ä»¤å’Œ function å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œè‡ªç„¶ä¹Ÿæ˜¯é¡¶å±‚å¯¹è±¡ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// f(){}</span>
</code></pre></div><p>ä½†ES6è§„å®šï¼Œvar å‘½ä»¤å’Œ function å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¾æ—§æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼Œä½† letå‘½ä»¤ã€constå‘½ä»¤ã€classå‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¸å±äºé¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> aa <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bb <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>aa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>bb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre></div><p>åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œç”¨ let å’Œ const å£°æ˜çš„å…¨å±€å˜é‡å¹¶æ²¡æœ‰åœ¨å…¨å±€å¯¹è±¡ä¸­ï¼Œåªæ˜¯ä¸€ä¸ªå—çº§ä½œç”¨åŸŸï¼ˆScriptï¼‰ä¸­</p> <p>æ€ä¹ˆè·å–ï¼Ÿåœ¨å®šä¹‰å˜é‡çš„å—çº§ä½œç”¨åŸŸä¸­å°±èƒ½è·å–å•Šï¼Œæ—¢ç„¶ä¸å±äºé¡¶å±‚å¯¹è±¡ï¼Œé‚£å°±ä¸åŠ  windowï¼ˆglobalï¼‰å‘—ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> aa <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bb <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>aa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre></div><h2 id="_18-æ”¹é€ ä¸‹é¢çš„ä»£ç -ä½¿ä¹‹è¾“å‡º0-9-å†™å‡ºä½ èƒ½æƒ³åˆ°çš„æ‰€æœ‰è§£æ³•"><a href="#_18-æ”¹é€ ä¸‹é¢çš„ä»£ç -ä½¿ä¹‹è¾“å‡º0-9-å†™å‡ºä½ èƒ½æƒ³åˆ°çš„æ‰€æœ‰è§£æ³•" class="header-anchor">#</a> 18. æ”¹é€ ä¸‹é¢çš„ä»£ç ï¼Œä½¿ä¹‹è¾“å‡º0 - 9ï¼Œå†™å‡ºä½ èƒ½æƒ³åˆ°çš„æ‰€æœ‰è§£æ³•</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="header-anchor">#</a> æ–¹æ³•ä¸€</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åŸç†ï¼šåˆ©ç”¨ <code>let</code> å˜é‡çš„ç‰¹æ€§ â€” åœ¨æ¯ä¸€æ¬¡ <code>for</code> å¾ªç¯çš„è¿‡ç¨‹ä¸­ï¼Œ<code>let</code> å£°æ˜çš„å˜é‡ä¼šåœ¨å½“å‰çš„å—çº§ä½œç”¨åŸŸé‡Œé¢ï¼ˆ<code>for</code> å¾ªç¯çš„ body ä½“ï¼Œä¹Ÿå³ä¸¤ä¸ªèŠ±æ‹¬å·ä¹‹é—´çš„å†…å®¹åŒºåŸŸï¼‰åˆ›å»ºä¸€ä¸ªæ–‡æ³•ç¯å¢ƒï¼ˆLexical Environmentï¼‰ï¼Œè¯¥ç¯å¢ƒé‡Œé¢åŒ…æ‹¬äº†å½“å‰ <code>for</code> å¾ªç¯è¿‡ç¨‹ä¸­çš„ <code>i</code></p> <h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="header-anchor">#</a> æ–¹æ³•äºŒ</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åŸç†ï¼šåˆ©ç”¨ <code>setTimeout</code> å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä¼šä½œä¸ºå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥</p> <h2 id="_19-virtual-dom-çœŸçš„æ¯”æ“ä½œåŸç”Ÿ-dom-å¿«å—-è°ˆè°ˆä½ çš„æƒ³æ³•"><a href="#_19-virtual-dom-çœŸçš„æ¯”æ“ä½œåŸç”Ÿ-dom-å¿«å—-è°ˆè°ˆä½ çš„æƒ³æ³•" class="header-anchor">#</a> 19. Virtual DOM çœŸçš„æ¯”æ“ä½œåŸç”Ÿ DOM å¿«å—ï¼Ÿè°ˆè°ˆä½ çš„æƒ³æ³•</h2> <p><a href="https://www.zhihu.com/question/31809713/answer/53544875" target="_blank" rel="noopener noreferrer">å°¤é›¨æºªçš„çŸ¥ä¹å›ç­”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_1-åŸç”Ÿ-dom-æ“ä½œ-vs-é€šè¿‡æ¡†æ¶å°è£…æ“ä½œ"><a href="#_1-åŸç”Ÿ-dom-æ“ä½œ-vs-é€šè¿‡æ¡†æ¶å°è£…æ“ä½œ" class="header-anchor">#</a> 1. åŸç”Ÿ DOM æ“ä½œ vs. é€šè¿‡æ¡†æ¶å°è£…æ“ä½œ</h3> <p>è¿™æ˜¯ä¸€ä¸ªæ€§èƒ½ vs. å¯ç»´æŠ¤æ€§çš„å–èˆã€‚æ¡†æ¶çš„æ„ä¹‰åœ¨äºä¸ºä½ æ©ç›–åº•å±‚çš„ DOM æ“ä½œï¼Œè®©ä½ ç”¨æ›´å£°æ˜å¼çš„æ–¹å¼æ¥æè¿°ä½ çš„ç›®çš„ï¼Œä»è€Œè®©ä½ çš„ä»£ç æ›´å®¹æ˜“ç»´æŠ¤ã€‚æ²¡æœ‰ä»»ä½•æ¡†æ¶å¯ä»¥æ¯”çº¯æ‰‹åŠ¨çš„ä¼˜åŒ– DOM æ“ä½œæ›´å¿«ï¼Œå› ä¸ºæ¡†æ¶çš„ DOM æ“ä½œå±‚éœ€è¦åº”å¯¹ä»»ä½•ä¸Šå±‚ API å¯èƒ½äº§ç”Ÿçš„æ“ä½œï¼Œå®ƒçš„å®ç°å¿…é¡»æ˜¯æ™®é€‚çš„ã€‚é’ˆå¯¹ä»»ä½•ä¸€ä¸ª benchmarkï¼Œæˆ‘éƒ½å¯ä»¥å†™å‡ºæ¯”ä»»ä½•æ¡†æ¶æ›´å¿«çš„æ‰‹åŠ¨ä¼˜åŒ–ï¼Œä½†æ˜¯é‚£æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿåœ¨æ„å»ºä¸€ä¸ªå®é™…åº”ç”¨çš„æ—¶å€™ï¼Œä½ éš¾é“ä¸ºæ¯ä¸€ä¸ªåœ°æ–¹éƒ½å»åšæ‰‹åŠ¨ä¼˜åŒ–å—ï¼Ÿå‡ºäºå¯ç»´æŠ¤æ€§çš„è€ƒè™‘ï¼Œè¿™æ˜¾ç„¶ä¸å¯èƒ½ã€‚æ¡†æ¶ç»™ä½ çš„ä¿è¯æ˜¯ï¼Œä½ åœ¨ä¸éœ€è¦æ‰‹åŠ¨ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä¾ç„¶å¯ä»¥ç»™ä½ æä¾›è¿‡å¾—å»çš„æ€§èƒ½ã€‚</p> <h3 id="_2-å¯¹-react-çš„-virtual-dom-çš„è¯¯è§£"><a href="#_2-å¯¹-react-çš„-virtual-dom-çš„è¯¯è§£" class="header-anchor">#</a> 2. å¯¹ React çš„ Virtual DOM çš„è¯¯è§£</h3> <p>React ä»æ¥æ²¡æœ‰è¯´è¿‡ â€œReact æ¯”åŸç”Ÿæ“ä½œ DOM å¿«â€ã€‚React çš„åŸºæœ¬æ€ç»´æ¨¡å¼æ˜¯æ¯æ¬¡æœ‰å˜åŠ¨å°±æ•´ä¸ªé‡æ–°æ¸²æŸ“æ•´ä¸ªåº”ç”¨ã€‚å¦‚æœæ²¡æœ‰ Virtual DOMï¼Œç®€å•æ¥æƒ³å°±æ˜¯ç›´æ¥é‡ç½® innerHTMLã€‚å¾ˆå¤šäººéƒ½æ²¡æœ‰æ„è¯†åˆ°ï¼Œåœ¨ä¸€ä¸ªå¤§å‹åˆ—è¡¨æ‰€æœ‰æ•°æ®éƒ½å˜äº†çš„æƒ…å†µä¸‹ï¼Œé‡ç½® innerHTML å…¶å®æ˜¯ä¸€ä¸ªè¿˜ç®—åˆç†çš„æ“ä½œ... çœŸæ­£çš„é—®é¢˜æ˜¯åœ¨ â€œå…¨éƒ¨é‡æ–°æ¸²æŸ“â€ çš„æ€ç»´æ¨¡å¼ä¸‹ï¼Œå³ä½¿åªæœ‰ä¸€è¡Œæ•°æ®å˜äº†ï¼Œå®ƒä¹Ÿéœ€è¦é‡ç½®æ•´ä¸ª innerHTMLï¼Œè¿™æ—¶å€™æ˜¾ç„¶å°±æœ‰å¤§é‡çš„æµªè´¹ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒä¸€ä¸‹ innerHTML vs. Virtual DOM çš„é‡ç»˜æ€§èƒ½æ¶ˆè€—ï¼š</p> <ul><li>innerHTML: render html string O(template size) + é‡æ–°åˆ›å»ºæ‰€æœ‰ DOM å…ƒç´  O(DOM size)</li> <li>Virtual DOM: render Virtual DOM + diff O(template size) + å¿…è¦çš„ DOM æ›´æ–° O(DOM change)</li></ul> <p>Virtual DOM render + diff æ˜¾ç„¶æ¯”æ¸²æŸ“ html å­—ç¬¦ä¸²è¦æ…¢ï¼Œä½†æ˜¯ï¼å®ƒä¾ç„¶æ˜¯çº¯ js å±‚é¢çš„è®¡ç®—ï¼Œæ¯”èµ·åé¢çš„ DOM æ“ä½œæ¥è¯´ï¼Œä¾ç„¶ä¾¿å®œäº†å¤ªå¤šã€‚å¯ä»¥çœ‹åˆ°ï¼ŒinnerHTML çš„æ€»è®¡ç®—é‡ä¸ç®¡æ˜¯ js è®¡ç®—è¿˜æ˜¯ DOM æ“ä½œéƒ½æ˜¯å’Œæ•´ä¸ªç•Œé¢çš„å¤§å°ç›¸å…³ï¼Œä½† Virtual DOM çš„è®¡ç®—é‡é‡Œé¢ï¼Œåªæœ‰ js è®¡ç®—å’Œç•Œé¢å¤§å°ç›¸å…³ï¼ŒDOM æ“ä½œæ˜¯å’Œæ•°æ®çš„å˜åŠ¨é‡ç›¸å…³çš„ã€‚å‰é¢è¯´äº†ï¼Œå’Œ DOM æ“ä½œæ¯”èµ·æ¥ï¼Œjs è®¡ç®—æ˜¯æå…¶ä¾¿å®œçš„ã€‚è¿™æ‰æ˜¯ä¸ºä»€ä¹ˆè¦æœ‰ Virtual DOMï¼šå®ƒä¿è¯äº† 1ï¼‰ä¸ç®¡ä½ çš„æ•°æ®å˜åŒ–å¤šå°‘ï¼Œæ¯æ¬¡é‡ç»˜çš„æ€§èƒ½éƒ½å¯ä»¥æ¥å—ï¼›2) ä½ ä¾ç„¶å¯ä»¥ç”¨ç±»ä¼¼ innerHTML çš„æ€è·¯å»å†™ä½ çš„åº”ç”¨ã€‚</p> <h3 id="_3-mvvm-vs-virtual-dom"><a href="#_3-mvvm-vs-virtual-dom" class="header-anchor">#</a> 3. MVVM vs. Virtual DOM</h3> <p>ç›¸æ¯”èµ· Reactï¼Œå…¶ä»– MVVM ç³»æ¡†æ¶æ¯”å¦‚ Angular, Knockout ä»¥åŠ Vueã€Avalon é‡‡ç”¨çš„éƒ½æ˜¯æ•°æ®ç»‘å®šï¼šé€šè¿‡ Directive/Binding å¯¹è±¡ï¼Œè§‚å¯Ÿæ•°æ®å˜åŒ–å¹¶ä¿ç•™å¯¹å®é™… DOM å…ƒç´ çš„å¼•ç”¨ï¼Œå½“æœ‰æ•°æ®å˜åŒ–æ—¶è¿›è¡Œå¯¹åº”çš„æ“ä½œã€‚MVVM çš„å˜åŒ–æ£€æŸ¥æ˜¯æ•°æ®å±‚é¢çš„ï¼Œè€Œ React çš„æ£€æŸ¥æ˜¯ DOM ç»“æ„å±‚é¢çš„ã€‚MVVM çš„æ€§èƒ½ä¹Ÿæ ¹æ®å˜åŠ¨æ£€æµ‹çš„å®ç°åŸç†æœ‰æ‰€ä¸åŒï¼šAngular çš„è„æ£€æŸ¥ä½¿å¾—ä»»ä½•å˜åŠ¨éƒ½æœ‰å›ºå®šçš„
O(watcher count) çš„ä»£ä»·ï¼›Knockout/Vue/Avalon éƒ½é‡‡ç”¨äº†ä¾èµ–æ”¶é›†ï¼Œåœ¨ js å’Œ DOM å±‚é¢éƒ½æ˜¯ O(change)ï¼š</p> <ul><li>è„æ£€æŸ¥ï¼šscope digest O(watcher count) + å¿…è¦ DOM æ›´æ–° O(DOM change)</li> <li>ä¾èµ–æ”¶é›†ï¼šé‡æ–°æ”¶é›†ä¾èµ– O(data change) + å¿…è¦ DOM æ›´æ–° O(DOM change)å¯ä»¥çœ‹åˆ°ï¼ŒAngular æœ€ä¸æ•ˆç‡çš„åœ°æ–¹åœ¨äºä»»ä½•å°å˜åŠ¨éƒ½æœ‰çš„å’Œ watcher æ•°é‡ç›¸å…³çš„æ€§èƒ½ä»£ä»·ã€‚ä½†æ˜¯ï¼å½“æ‰€æœ‰æ•°æ®éƒ½å˜äº†çš„æ—¶å€™ï¼ŒAngular å…¶å®å¹¶ä¸åƒäºã€‚ä¾èµ–æ”¶é›†åœ¨åˆå§‹åŒ–å’Œæ•°æ®å˜åŒ–çš„æ—¶å€™éƒ½éœ€è¦é‡æ–°æ”¶é›†ä¾èµ–ï¼Œè¿™ä¸ªä»£ä»·åœ¨å°é‡æ›´æ–°çš„æ—¶å€™å‡ ä¹å¯ä»¥å¿½ç•¥ï¼Œä½†åœ¨æ•°æ®é‡åºå¤§çš„æ—¶å€™ä¹Ÿä¼šäº§ç”Ÿä¸€å®šçš„æ¶ˆè€—ã€‚</li></ul> <p>MVVM æ¸²æŸ“åˆ—è¡¨çš„æ—¶å€™ï¼Œç”±äºæ¯ä¸€è¡Œéƒ½æœ‰è‡ªå·±çš„æ•°æ®ä½œç”¨åŸŸï¼Œæ‰€ä»¥é€šå¸¸éƒ½æ˜¯æ¯ä¸€è¡Œæœ‰ä¸€ä¸ªå¯¹åº”çš„ ViewModel å®ä¾‹ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç¨å¾®è½»é‡ä¸€äº›çš„åˆ©ç”¨åŸå‹ç»§æ‰¿çš„ &quot;scope&quot; å¯¹è±¡ï¼Œä½†ä¹Ÿæœ‰ä¸€å®šçš„ä»£ä»·ã€‚æ‰€ä»¥ï¼ŒMVVM åˆ—è¡¨æ¸²æŸ“çš„åˆå§‹åŒ–å‡ ä¹ä¸€å®šæ¯” React æ…¢ï¼Œå› ä¸ºåˆ›å»º ViewModel / scope å®ä¾‹æ¯”èµ· Virtual DOM æ¥è¯´è¦æ˜‚è´µå¾ˆå¤šã€‚è¿™é‡Œæ‰€æœ‰ MVVM å®ç°çš„ä¸€ä¸ªå…±åŒé—®é¢˜å°±æ˜¯åœ¨åˆ—è¡¨æ¸²æŸ“çš„æ•°æ®æºå˜åŠ¨æ—¶ï¼Œå°¤å…¶æ˜¯å½“æ•°æ®æ˜¯å…¨æ–°çš„å¯¹è±¡æ—¶ï¼Œå¦‚ä½•æœ‰æ•ˆåœ°å¤ç”¨å·²ç»åˆ›å»ºçš„ ViewModel å®ä¾‹å’Œ DOM å…ƒç´ ã€‚å‡å¦‚æ²¡æœ‰ä»»ä½•å¤ç”¨æ–¹é¢çš„ä¼˜åŒ–ï¼Œç”±äºæ•°æ®æ˜¯ â€œå…¨æ–°â€ çš„ï¼ŒMVVM å®é™…ä¸Šéœ€è¦é”€æ¯ä¹‹å‰çš„æ‰€æœ‰å®ä¾‹ï¼Œé‡æ–°åˆ›å»ºæ‰€æœ‰å®ä¾‹ï¼Œæœ€åå†è¿›è¡Œä¸€æ¬¡æ¸²æŸ“ï¼è¿™å°±æ˜¯ä¸ºä»€ä¹ˆé¢˜ç›®é‡Œé“¾æ¥çš„ angular/knockout å®ç°éƒ½ç›¸å¯¹æ¯”è¾ƒæ…¢ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒReact çš„å˜åŠ¨æ£€æŸ¥ç”±äºæ˜¯ DOM ç»“æ„å±‚é¢çš„ï¼Œå³ä½¿æ˜¯å…¨æ–°çš„æ•°æ®ï¼Œåªè¦æœ€åæ¸²æŸ“ç»“æœæ²¡å˜ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦åšæ— ç”¨åŠŸã€‚</p> <p>Angular å’Œ Vue éƒ½æä¾›äº†åˆ—è¡¨é‡ç»˜çš„ä¼˜åŒ–æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯ â€œæç¤ºâ€ æ¡†æ¶å¦‚ä½•æœ‰æ•ˆåœ°å¤ç”¨å®ä¾‹å’Œ DOM å…ƒç´ ã€‚æ¯”å¦‚æ•°æ®åº“é‡Œçš„åŒä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨ä¸¤æ¬¡å‰ç«¯ API è°ƒç”¨é‡Œé¢ä¼šæˆä¸ºä¸åŒçš„å¯¹è±¡ï¼Œä½†æ˜¯å®ƒä»¬ä¾ç„¶æœ‰ä¸€æ ·çš„ uidã€‚è¿™æ—¶å€™ä½ å°±å¯ä»¥æç¤º track by uid æ¥è®© Angular çŸ¥é“ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å…¶å®æ˜¯åŒä¸€ä»½æ•°æ®ã€‚é‚£ä¹ˆåŸæ¥è¿™ä»½æ•°æ®å¯¹åº”çš„å®ä¾‹å’Œ DOM å…ƒç´ éƒ½å¯ä»¥å¤ç”¨ï¼Œåªéœ€è¦æ›´æ–°å˜åŠ¨äº†çš„éƒ¨åˆ†ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ track by $index æ¥è¿›è¡Œ â€œåŸåœ°å¤ç”¨â€ï¼šç›´æ¥æ ¹æ®åœ¨æ•°ç»„é‡Œçš„ä½ç½®è¿›è¡Œå¤ç”¨ã€‚åœ¨é¢˜ç›®ç»™å‡ºçš„ä¾‹å­é‡Œï¼Œå¦‚æœ angular å®ç°åŠ ä¸Š track by $index çš„è¯ï¼Œåç»­é‡ç»˜æ˜¯ä¸ä¼šæ¯” React æ…¢å¤šå°‘çš„ã€‚ç”šè‡³åœ¨ dbmonster æµ‹è¯•ä¸­ï¼ŒAngular å’Œ Vue ç”¨äº† track by $index ä»¥åéƒ½æ¯” React å¿«: dbmon (æ³¨æ„ Angular é»˜è®¤ç‰ˆæœ¬æ— ä¼˜åŒ–ï¼Œä¼˜åŒ–è¿‡çš„åœ¨ä¸‹é¢ï¼‰</p> <p>é¡ºé“è¯´ä¸€å¥ï¼ŒReact æ¸²æŸ“åˆ—è¡¨çš„æ—¶å€™ä¹Ÿéœ€è¦æä¾› key è¿™ä¸ªç‰¹æ®Š propï¼Œæœ¬è´¨ä¸Šå’Œ track-by æ˜¯ä¸€å›äº‹ã€‚</p> <h3 id="_4-æ€§èƒ½æ¯”è¾ƒä¹Ÿè¦çœ‹åœºåˆ"><a href="#_4-æ€§èƒ½æ¯”è¾ƒä¹Ÿè¦çœ‹åœºåˆ" class="header-anchor">#</a> 4. æ€§èƒ½æ¯”è¾ƒä¹Ÿè¦çœ‹åœºåˆ</h3> <p>åœ¨æ¯”è¾ƒæ€§èƒ½çš„æ—¶å€™ï¼Œè¦åˆ†æ¸…æ¥šåˆå§‹æ¸²æŸ“ã€å°é‡æ•°æ®æ›´æ–°ã€å¤§é‡æ•°æ®æ›´æ–°è¿™äº›ä¸åŒçš„åœºåˆã€‚Virtual DOMã€è„æ£€æŸ¥ MVVMã€æ•°æ®æ”¶é›† MVVM åœ¨ä¸åŒåœºåˆå„æœ‰ä¸åŒçš„è¡¨ç°å’Œä¸åŒçš„ä¼˜åŒ–éœ€æ±‚ã€‚Virtual DOM ä¸ºäº†æå‡å°é‡æ•°æ®æ›´æ–°æ—¶çš„æ€§èƒ½ï¼Œä¹Ÿéœ€è¦é’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼Œæ¯”å¦‚ shouldComponentUpdate æˆ–æ˜¯ immutable dataã€‚</p> <ul><li>åˆå§‹æ¸²æŸ“ï¼šVirtual DOM &gt; è„æ£€æŸ¥ &gt;= ä¾èµ–æ”¶é›†</li> <li>å°é‡æ•°æ®æ›´æ–°ï¼šä¾èµ–æ”¶é›† &gt;&gt; Virtual DOM + ä¼˜åŒ– &gt; è„æ£€æŸ¥ï¼ˆæ— æ³•ä¼˜åŒ–ï¼‰ &gt; Virtual DOM æ— ä¼˜åŒ–</li> <li>å¤§é‡æ•°æ®æ›´æ–°ï¼šè„æ£€æŸ¥ + ä¼˜åŒ– &gt;= ä¾èµ–æ”¶é›† + ä¼˜åŒ– &gt; Virtual DOMï¼ˆæ— æ³•/æ— éœ€ä¼˜åŒ–ï¼‰&gt;&gt; MVVM æ— ä¼˜åŒ–</li></ul> <p>ä¸è¦å¤©çœŸåœ°ä»¥ä¸º Virtual DOM å°±æ˜¯å¿«ï¼Œdiff ä¸æ˜¯å…è´¹çš„ï¼Œbatching ä¹ˆ MVVM ä¹Ÿèƒ½åšï¼Œè€Œä¸”æœ€ç»ˆ patch çš„æ—¶å€™è¿˜ä¸æ˜¯è¦ç”¨åŸç”Ÿ APIã€‚åœ¨æˆ‘çœ‹æ¥ Virtual DOM çœŸæ­£çš„ä»·å€¼ä»æ¥éƒ½ä¸æ˜¯æ€§èƒ½ï¼Œè€Œæ˜¯å®ƒ 1) ä¸ºå‡½æ•°å¼çš„ UI ç¼–ç¨‹æ–¹å¼æ‰“å¼€äº†å¤§é—¨ï¼›2) å¯ä»¥æ¸²æŸ“åˆ° DOM ä»¥å¤–çš„ backendï¼Œæ¯”å¦‚ ReactNativeã€‚</p> <h3 id="_5-æ€»ç»“"><a href="#_5-æ€»ç»“" class="header-anchor">#</a> 5. æ€»ç»“</h3> <p>ä»¥ä¸Šè¿™äº›æ¯”è¾ƒï¼Œæ›´å¤šçš„æ˜¯å¯¹äºæ¡†æ¶å¼€å‘ç ”ç©¶è€…æä¾›ä¸€äº›å‚è€ƒã€‚ä¸»æµçš„æ¡†æ¶ + åˆç†çš„ä¼˜åŒ–ï¼Œè¶³ä»¥åº”å¯¹ç»å¤§éƒ¨åˆ†åº”ç”¨çš„æ€§èƒ½éœ€æ±‚ã€‚å¦‚æœæ˜¯å¯¹æ€§èƒ½æœ‰æè‡´éœ€æ±‚çš„ç‰¹æ®Šæƒ…å†µï¼Œå…¶å®åº”è¯¥ç‰ºç‰²ä¸€äº›å¯ç»´æŠ¤æ€§é‡‡å–æ‰‹åŠ¨ä¼˜åŒ–ï¼šæ¯”å¦‚ Atom ç¼–è¾‘å™¨åœ¨æ–‡ä»¶æ¸²æŸ“çš„å®ç°ä¸Šæ”¾å¼ƒäº† React è€Œé‡‡ç”¨äº†è‡ªå·±å®ç°çš„ tile-based renderingï¼›åˆæ¯”å¦‚åœ¨ç§»åŠ¨ç«¯éœ€è¦ DOM-pooling çš„è™šæ‹Ÿæ»šåŠ¨ï¼Œä¸éœ€è¦è€ƒè™‘é¡ºåºå˜åŒ–ï¼Œå¯ä»¥ç»•è¿‡æ¡†æ¶çš„å†…ç½®å®ç°è‡ªå·±æä¸€ä¸ªã€‚</p> <h2 id="_20-ä¸‹é¢çš„ä»£ç æ‰“å°ä»€ä¹ˆå†…å®¹-ä¸ºä»€ä¹ˆ"><a href="#_20-ä¸‹é¢çš„ä»£ç æ‰“å°ä»€ä¹ˆå†…å®¹-ä¸ºä»€ä¹ˆ" class="header-anchor">#</a> 20. ä¸‹é¢çš„ä»£ç æ‰“å°ä»€ä¹ˆå†…å®¹ï¼Œä¸ºä»€ä¹ˆ</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>è¿”å›ä¸€ä¸ªå‡½æ•°</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Æ’ <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½œç”¨åŸŸï¼šæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­åŒ…å«ä½œç”¨åŸŸé“¾ï¼š
åœ¨ç†è§£ä½œç”¨åŸŸé“¾ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹ä½œç”¨åŸŸï¼Œä½œç”¨åŸŸå¯ä»¥ç†è§£ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ç”³æ˜çš„å˜é‡å’Œä½œç”¨çš„èŒƒå›´ï¼›åŒ…æ‹¬å—çº§ä½œç”¨åŸŸ/å‡½æ•°ä½œç”¨åŸŸï¼›
ç‰¹æ€§ï¼šå£°æ˜æå‰ï¼šä¸€ä¸ªå£°æ˜åœ¨å‡½æ•°ä½“å†…éƒ½æ˜¯å¯è§çš„ï¼Œå‡½æ•°å£°æ˜ä¼˜å…ˆäºå˜é‡å£°æ˜ï¼›
åœ¨éåŒ¿åè‡ªæ‰§è¡Œå‡½æ•°ä¸­ï¼Œå‡½æ•°å˜é‡ä¸ºåªè¯»çŠ¶æ€æ— æ³•ä¿®æ”¹ï¼›</p> <h2 id="_21-ç®€å•æ”¹é€ ä¸‹é¢çš„ä»£ç -ä½¿ä¹‹åˆ†åˆ«æ‰“å°-10-å’Œ-20"><a href="#_21-ç®€å•æ”¹é€ ä¸‹é¢çš„ä»£ç -ä½¿ä¹‹åˆ†åˆ«æ‰“å°-10-å’Œ-20" class="header-anchor">#</a> 21. ç®€å•æ”¹é€ ä¸‹é¢çš„ä»£ç ï¼Œä½¿ä¹‹åˆ†åˆ«æ‰“å° 10 å’Œ 20</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æ‰“å°10"><a href="#æ‰“å°10" class="header-anchor">#</a> æ‰“å°10</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æ‰“å°20"><a href="#æ‰“å°20" class="header-anchor">#</a> æ‰“å°20</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_22-å®ç°ä¸€ä¸ª-sleep-å‡½æ•°"><a href="#_22-å®ç°ä¸€ä¸ª-sleep-å‡½æ•°" class="header-anchor">#</a> 22. å®ç°ä¸€ä¸ª sleep å‡½æ•°</h2> <blockquote><p>æ¯”å¦‚ sleep(1000) æ„å‘³ç€ç­‰å¾…1000æ¯«ç§’ï¼Œå¯ä» Promiseã€Generatorã€Async/Await ç­‰è§’åº¦å®ç°</p></blockquote> <h3 id="promiseå®ç°"><a href="#promiseå®ç°" class="header-anchor">#</a> Promiseå®ç°</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1ç§’é’Ÿåæ‰§è¡Œ'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="async-awaitå®ç°"><a href="#async-awaitå®ç°" class="header-anchor">#</a> Async/Awaitå®ç°</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">sleepAsync</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1ç§’ä¸­åæ‰§è¡Œ'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">sleepAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_23-ä½¿ç”¨-sort-å¯¹æ•°ç»„-3-15-8-29-102-22-è¿›è¡Œæ’åº-è¾“å‡ºç»“æœ"><a href="#_23-ä½¿ç”¨-sort-å¯¹æ•°ç»„-3-15-8-29-102-22-è¿›è¡Œæ’åº-è¾“å‡ºç»“æœ" class="header-anchor">#</a> 23. ä½¿ç”¨ sort() å¯¹æ•°ç»„ [3, 15, 8, 29, 102, 22] è¿›è¡Œæ’åºï¼Œè¾“å‡ºç»“æœ</h2> <p>ç»“æœä¸ºï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span>
</code></pre></div><p><code>arr.sort([compareFunction])</code></p> <p><code>sort()</code> æ–¹æ³•ç”¨åŸåœ°ç®—æ³•å¯¹æ•°ç»„çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œå¹¶è¿”å›æ•°ç»„ã€‚é»˜è®¤æ’åºé¡ºåºæ˜¯åœ¨å°†å…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ¯”è¾ƒå®ƒä»¬çš„UTF-16ä»£ç å•å…ƒå€¼åºåˆ—æ—¶æ„å»ºçš„ã€‚</p> <p>å¦‚éœ€è¦æŒ‰ç…§å¤§å°è¿›è¡Œæ’åºåˆ™éœ€è¦æ·»åŠ å‡½æ•°</p> <p><code>arr.sort(a - b)</code></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/1/2020, 10:12:26 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><div></div></div></div>
    <script src="/assets/js/app.feb85b9e.js" defer></script><script src="/assets/js/2.95f1b8bb.js" defer></script><script src="/assets/js/53.83955275.js" defer></script>
  </body>
</html>
